# Publish a package

## Edit files

### Your .csproj

Start by changing the information in the "src/ConsoleAppVisuals/ConsoleAppVisuals.csproj" file (as you won't be able to push on my name obviously...)

```xml
<PropertyGroup>
    <TargetFramework>net7.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <GenerateDocumentationFile>true</GenerateDocumentationFile>
  </PropertyGroup>

  <PropertyGroup> 
    <Title>ConsoleAppVisuals</Title>
    <PackageId>ConsoleAppVisuals</PackageId> <!-- Change this by the name of your package, it must be unique -->
    <Authors>MorganK</Authors> <!-- Change this by the name of the publisher on nuget.org -->
    <Version>0.0.0</Version> <!-- Change this by the version of your package -->
    <Description>Easy to use C# library for any console app</Description> <!-- Change this by the description of your package -->
    <PackageLicenceExpression>MIT</PackageLicenceExpression>
    <PackageTags>Visuals, ConsoleApp</PackageTags> <!-- Change this by the tags of your package -->
    <RepositoryUrl>https://github.com/MorganKryze/ConsoleAppVisuals</RepositoryUrl> <!-- Change this by the url of your repository on GitHub -->
    <RepositoryType>git</RepositoryType>
    <PackageReadmeFile>README.md</PackageReadmeFile> <!-- This is optional, it will add the README.md file of your project to the package -->
    <PackageLicenseFile>LICENSE</PackageLicenseFile>
    <PackageIcon>icon.png</PackageIcon>
  </PropertyGroup>
  

  <ItemGroup>
    <None Include="..\..\README.md" Pack="true" PackagePath=""/>  <!-- This is mandatory, this include indicates the path to the files declared previously -->
    <None Include="..\..\LICENSE" Pack="true" PackagePath=""/>
    <None Include="img/icon.png" Pack="true" PackagePath=""/>
  </ItemGroup>
```

> [!TIP]
> You need to change the licence of the project by your own licence.

### Build the project

In your terminal, at the root directory of the project (ConsoleAppVisuals), run the following commands:

```bash
dotnet build -c Release

dotnet pack -c Release
```

You will then find the NuGet package in the "bin/Release" folder of your project.

## NuGet account

### Create a NuGet account

You need to create a NuGet account [here](https://www.nuget.org/users/account/LogOn?returnUrl=%2F).

> [!TIP]
> Preferably, use an outlook email address.

### Create an API key

Then, you need to create an API key [here](https://www.nuget.org/account/apikeys) and copy it to your clipboard.

> [!IMPORTANT]
> Set your API key as a secret of your repository on GitHub and name it "NUGET_API_KEY". Paste your API key in the value field.

You also need to create a GitHub personal API key. To do so, get to [this page](https://github.com/settings/tokens).

### Publish your package

Back to your source code, you may slightly modify the workflow ".github/workflows/publish.yml" file, to add your username.

```yml
- name: Push to GitHub Packages
      run: dotnet nuget push ConsoleAppVisuals.${VERSION}.nupkg --source https://nuget.pkg.github.com/<Insert_your_GitHub_Username>/index.json --api-key ${GITHUB_TOKEN}
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

> [!NOTE]
> Remove the "<>" when you insert your username. The GITHUB_TOKEN is automatically generated by GitHub, no need to worry or change anything about it (if you created a token previously).

Then, commit your changes and push them to your repository. If you do not push directly to your main, you may want to create a pull request.

Finally, create a new release and add a tag to it as follow "vX.X.X" where X is a number representing the version of your package.

> [!TIP]
> Wait a few minutes and you will find your package on NuGet.org and GitHub packages, you will be notified by email.

## Resources

[Official NuGet documentation](https://learn.microsoft.com/nuget/quickstart/create-and-publish-a-package-using-the-dotnet-cli)

[Main Source](https://acraven.medium.com/a-nuget-package-workflow-using-github-actions-7da8c6557863)

[Recap](https://levelup.gitconnected.com/publish-to-nuget-with-github-actions-4e1486e7c19f)
